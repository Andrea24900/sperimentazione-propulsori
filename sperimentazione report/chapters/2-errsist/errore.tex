\section{Stima dell'errore sistematico}

\paragraph{Dati e richieste}
Viene fornita la tabella di calibrazione statica di una termocoppia di tipo B, riportata in Tab. \ref{tab:calibrazione statica}. Si chiede di ricavare la relazione temperatura misurata-tensione mediante analisi di regressione, di determinare l'errore associato a tale processo, nonché il grado di adattamento del modello ai dati sperimentali. Infine si richiede di determinare l'errore totale associato alle misure di temperatura delle due serie di Sez.\ref{sez:misureT}.

\begin{table}[H]
	\centering
\begin{tabular}{c|c}
	\toprule\toprule
	\textbf{Tensione [mV]} & \textbf{Temperatura [°C]} \\ 
	\midrule\midrule
	0.786 & 400 \\ \midrule
	1.791 & 600 \\ \midrule
	2.431 & 700 \\ \midrule
	2.784 & 750 \\ \midrule
	3.158 & 800 \\ \midrule
	3.551 & 850 \\ \midrule
	3.963 & 900 \\ \midrule
	4.395 & 950 \\ \midrule
	4.844 & 1000 \\ \midrule
	5.311 & 1050 \\ \midrule
	5.793 & 1100 \\ \midrule
	6.290 & 1150 \\ \midrule
	6.800 & 1200 \\ \midrule
	7.326 & 1250 \\ \midrule
	7.866 & 1300 \\ \midrule
	8.418 & 1350 \\ \midrule
	8.979 & 1400 \\ \midrule
	9.549 & 1450 \\ \midrule
	10.124 & 1500 \\ \midrule
	10.704 & 1550 \\ \midrule
	11.286 & 1600 \\ 
	\bottomrule\bottomrule
\end{tabular}
\caption{Tabella di calibrazione statica}
\label{tab:calibrazione statica}
\end{table}
\begin{figure}
	\centering
	\includegraphics[width=0.7\linewidth]{"../sperimentazione nei propulsori/calibration"}
	\caption{Serie di dati della tabella di calibrazione statica}
\label{fig:serie-calibrazione}
\end{figure}



\paragraph{Introduzione alla risoluzione}
Dalla rappresentazione di Fig.\ref{fig:serie-calibrazione} si nota che i dati sono caratterizzati da un andamento non lineare sull'intero campo di misura, mentre a partire da circa 6 mV si ha un andamento quasi lineare.
Di conseguenza, l'adozione di una legge di regressione non lineare appare ottimale per fornire un errore ridotto. Tuttavia la scelta del campo di misura è impattata da altri fattori, pertanto è opportuno delineare una strategia risolutiva che valuti più aspetti al fine di trovare la migliore soluzione. 


Si consideri la quantità \gls{symb:sigmaeps}, ossia l'errore di regressione, definita come:
\begin{equation}
	\sigma_{\varepsilon}^2= \frac{\Sigma_{i=1}^N \, (y_i - \tilde{y_i})^2}{N-G} 
\end{equation}
dove: 
\begin{itemize}
	\item $y_i$ è l'i-esimo valore misurato di \gls{symb:T};
	\item $\tilde{y_i}$ indica la stima di \gls{symb:T} ottenuta a ogni valore di tensione mediante la legge di regressione;
	\item $N$ indica il numero di coppie di dati usati per determinare i coefficienti di regressione. 
	\item $G$ indica il numero di coefficienti di regressione (vale $G = O + 1$, dove con $O$ si indica l'ordine del modello di regressione).
\end{itemize}
Utilizzare un numero elevato di punti permette di ridurre questo errore (aumento di $N$), così come un modello di ordine superiore ($G$ maggiore) riduce la somma degli scarti quadratici (numeratore della frazione), ma a parità di $N$ provoca la riduzione del denominatore con conseguente aumento dell'errore. 

Si evidenzia anche che il calcolo dell'errore sistematico (\gls{symb:errsist}) prevede di moltiplicare \gls{symb:sigmaeps} per la \gls{symb:t95} relativa al numero di gradi di libertà \gls{symb:nu}, ottenibile mediante $ \nu = N - G $ (il numero di gradi di libertà persi è pari al numero di coefficienti di regressione). A seguito di questa operazione si nota che la scelta di un numero limitato di punti per la regressione (N basso), associata a un modello di ordine alto, porta a \gls{symb:nu} molto bassi che comportano un significativo aumento di \gls{symb:errsist}.

Queste osservazioni motivano uno studio di ottimizzazione, con lo scopo di trovare l'ordine e il numero di coppie di dati di calibrazione che minimizzano globalmente l'errore sistematico. 
Poiché le due serie di dati presentano estremi differenti, lo studio viene proposto separatamente per entrambe.


\subsection{Risoluzione per serie corta}
Si presenta lo studio di ottimo per la prima serie di dati, svolto con le stesse modalità anche per la seconda. Il punto di partenza sono gli estremi della serie di dati, ossia la minima e massima \gls{symb:T} misurata, che assumono rispettivamente il valore di 953 \textsuperscript{o}C e di 1193 \textsuperscript{o}C. Da Tab.\ref{tab:calibrazione statica} si ricava che il minimo intervallo di dati su cui svolgere la regressione va da 950 \textsuperscript{o}C a 1200 \textsuperscript{o}C. A ogni iterazione questo secondo intervallo viene ampliato di un valore a sinistra dell'estremo inferiore e a destra dell'estremo superiore. Il più ampio intervallo possibile va da 400 \textsuperscript{o}C a 1550 \textsuperscript{o}C. 

Per ogni intervallo di dati di calibrazione sono determinati i coefficienti di regressione dal primo al quarto ordine (mediante funzione \textit{polyfit} di Matlab), poi vengono calcolate le stime $\tilde{y_i}$ per tutti gli ordini; successivamente si calcolano i $\sigma_{\varepsilon}$ e, infine, i valori di \gls{symb:errsist}. Per ogni iterazione viene selezionato l'ordine del polinomio interpolante che garantisce il minimo \gls{symb:errsist}; dopo aver ripetuto l'analisi per tutti gli intervalli si individua il miglior errore sistematico globale. 

L'analisi si conclude con l'indicazione del valore di \gls{symb:Rsquare}, che rappresenta il grado di adattamento del modello ai dati sperimentali; segue la stima dell'errore totale (\gls{symb:errtot}) del processo di misura, ottenuta mediante: 
\begin{equation}
	\epsilon_{\textit{TOT}}=\sqrt{\epsilon_{\textit{STAT}}^2+\epsilon_{\textit{SIST}}^2}
\end{equation}

Lo svolgimento del processo porta a determinare i seguenti errori sistematici, rappresentati in Fig.\ref{fig:errsistshort}: tra di essi viene indicato il minimo errore globale. 
\begin{figure}[H]
	\centering
	\includegraphics[width=0.6\linewidth]{"../sperimentazione nei propulsori/err_sist_short"}
	\caption{Risultati del processo di ottimizzazione}
	\label{fig:errsistshort}
\end{figure}
In Tab.\ref{tab:risshort} si riportano i risultati associati alla migliore soluzione; segue la rappresentazione della legge di calibrazione del quarto ordine (Fig.\ref{fig:shortlaw}) e i coefficienti (Tab.\ref{tab:coefficienti_short}).
La legge è nella forma:
\begin{equation}
	y = ax^4+bx^3+cx^2+dx+e
\end{equation}
\begin{table}[H]
	\centering
	\begin{tabular}{c|c}
		\toprule
		\toprule
		\textbf{Risultato} & \textbf{Valore} \\
		\midrule
		\midrule
		\gls{symb:errsist}& 0.1134 \textsuperscript{o}C\\
		\midrule
		\gls{symb:errsist} come \% F.S. & 0.0087 \%\\
		\midrule
		Ordine & 4 \\
		\midrule
		Intervallo & 850-1300 \textsuperscript{o}C\\
		\midrule
		\gls{symb:Rsquare} & $\sim$ 1\\
		\midrule
		\gls{symb:errstat} serie & 1.9202 \textsuperscript{o}C \\
		\midrule
		\gls{symb:errtot} & 1.9236 \textsuperscript{o}C \\
		\bottomrule
		\bottomrule
	\end{tabular}
\caption{Risultati serie corta}
\label{tab:risshort}
\end{table}

\begin{figure}[H]
	\centering
	\includegraphics[width=0.4\linewidth]{"../sperimentazione nei propulsori/short_law"}
	\caption{Curva di calibrazione statica}
	\label{fig:shortlaw}
\end{figure}

\begin{table}[H]
	\centering
	\begin{tabular}{c|c}
		\toprule
		\toprule
		\textbf{Coefficiente} & \textbf{Valore} \\
		\midrule
		\midrule
		a & -0.0715		\\
		\midrule
		b & 1.9853\\
		\midrule
		c &	-23.2057 \\
		\midrule
		d & 226.6665\\
		\midrule
		e & 260.2018\\
		\bottomrule
		\bottomrule
	\end{tabular}
\caption{Coefficienti della legge di calibrazione}
\label{tab:coefficienti_short}
\end{table}


Da questi risultati si osserva che l'errore sistematico è molto ridotto grazie all'adozione di un modello di ordine elevato. Si sottolinea, inoltre, come l'adozione di un campo di dati di calibrazione più ampio sia deleterio per l'errore sistematico anche con modelli di ordine elevato a causa dell'aumento dell'errore di interpolazione. 

Infine, si riporta una rappresentazione (Fig.\ref{fig:errsistshortesempio}) dell'errore sistematico per i vari ordini di modello usando l'intervallo ottimale di dati di calibrazione. Questa rappresentazione è particolarmente significativa in quanto si riscontra che, nonostante il lieve incremento del valore di \gls{symb:t95}, la soluzione migliore resta quella del quarto ordine. 


\begin{figure} [H]
	\centering
	\includegraphics[width=0.5\linewidth]{"../sperimentazione nei propulsori/err_sist_short_best"}
\caption{Errore sistematico della soluzione ottimale per vari ordini di regressione}
	\label{fig:errsistshortesempio}
\end{figure}


Questo effetto è determinante nella penalizzazione della soluzione con intervallo 950-1200 \textsuperscript{o}C, il cui errore di regressione è molto basso, ma viene moltiplicato per \gls{symb:t95} elevato, con un risultato molto deleterio sull'errore sistematico. 

\begin{figure} [H]
	\centering
	\includegraphics[width=0.5\linewidth]{"../sperimentazione nei propulsori/err_sist_short_test"}
	\caption{Confronto errori per la serie 950-1200 \textsuperscript{o}C}
	\label{fig:errsistshorttest}
\end{figure}

\subsection{Risoluzione per la serie lunga}
Si impiega una strategia analoga per caratterizzare la serie lunga. Quest'ultima presenta una limitata possibilità di ottimizzazione in quanto l'intervallo di temperatura da misurare è da 931 \textsuperscript{o}C a 1449 \textsuperscript{o}C:  questi valori comportano l'utilizzo di gran parte della tabella di calibrazione statica. Poiché l'analisi svolta è analoga alla precedente, vengono riportati soltanto i risultati. Si osserva che l'errore sistematico è ridotto e ha un impatto limitato sull'errore totale; inoltre, la legge di regressione che fornisce il miglior risultato è ancora quella del quarto ordine. 

\begin{figure} [H]
	\centering
	\includegraphics[width=0.6\linewidth]{"../sperimentazione nei propulsori/err_sist_long"}
	\caption{Risultati del processo di ottimizzazione}
	\label{fig:errsistlong}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width=0.4\linewidth]{"../sperimentazione nei propulsori/long_law"}
	\caption{Curva di calibrazione statica}
	\label{fig:longlaw}
\end{figure}
\begin{table}[H]
	\centering
	\begin{tabular}{c|c}
		\toprule
		\toprule
		\textbf{Risultato} & \textbf{Valore} \\
		\midrule
		\midrule
		\gls{symb:errsist}& 0.2436 \textsuperscript{o}C\\
		\midrule
		\gls{symb:errsist} come \% F.S. & 0.017 \%\\
		\midrule
		Ordine & 4 \\
		\midrule
		Intervallo & 900-1450 \textsuperscript{o}C\\
		\midrule
		\gls{symb:Rsquare} & $\sim$ 1\\
		\midrule
		\gls{symb:errstat} serie & 1.5259 \textsuperscript{o}C \\
		\midrule
		\gls{symb:errtot} & 1.5452 \textsuperscript{o}C \\
		\bottomrule
		\bottomrule
	\end{tabular}
	\caption{Risultati serie lunga}
	\label{tab:rislong}
\end{table}
\begin{table}[H]
	\centering
	\begin{tabular}{c|c}
		\toprule
		\toprule
		\textbf{Coefficiente} & \textbf{Valore} \\
		\midrule
		\midrule
		a & -0.0120		\\
		\midrule
		b & 0.5696\\
		\midrule
		c &	-10.8105 \\
		\midrule
		d & 179.4108\\
		\midrule
		e & 326.3550\\
		\bottomrule
		\bottomrule
	\end{tabular}
	\caption{Coefficienti della legge di calibrazione}
	\label{tab:coefficienti_long}
\end{table}